# Сбор из OGC-сервисов {#ogcwxs_harvester}

OGC-сервисы реализует операцию [GetCapabilities](https://docs.geoserver.org/stable/en/user/services/wms/reference.html#getcapabilities). 
Выступая в качестве клиента, GeoNetwork может использовать результаты запроса GetCapabilities **для формирования метаданных** для OGC-сервисов (ISO19119) и ресурсов, 
предоставляемых сервисом (ISO19115/19139). Этот сборщик поддерживает следующие типы OGC-сервисов:

- Web Map Service (WMS) - версии 1.0.0, 1.1.1, 1.3.0
- Web Feature Service (WFS) - версии 1.0.0 и 1.1.0
- Web Coverage Service (WCS) - версия 1.0.0
- Web Processing Service (WPS) - версии 0.4.0 и 1.0.0
- Catalogue Services for the Web (CSW) - версия 2.0.2
- Sensor Observation Service (SOS) - версия 1.0.0

## Сборщик данных с OGC-вебсервисов

Нажмите `Собрать из` - `Веб-сервисы OGC`, чтобы создать сборщик данных для OGC-вебсервисов. Доступные параметры следующие:

-   **Идентификация** - параметры собранных данных в каталоге GeoNetwork.
    -    *Имя* - Это краткое описание удаленного сайта. Оно будет показано на главной странице сбора в качестве имени для этого экземпляра CSW-харвестера.
    -    *Выбор логотипа* - Логотип будет использоваться при отображении собранных записей метаданных в результатах поиска.
    -    *Группа* - Группа, в которой разместятся собираемые метаданные.
    -    *Пользователь* - Пользователь, который будет владельцем собранных метаданных.
-   **Расписание** - Параметры расписания, согласно которым сборщик будет собирать метаданные.
    -    *Частота* - Частота (периодичность) запуска сбора метаданных харвестером.
    -    *Только один запуск* - Сборщик будет запущен только один раз, если выбран пункт.
-   **Настроить подключение** - параметры подключения к CSW-серверу.
    -    *URL сервиса* - URL CSW с параметрами GetCapabilities или без них. Например, <http://geonetwork-site.com/srv/eng/csw?service=CSW&request=GetCabilities&version=2.0.2>.
    -    *Тип сервиса* - Нужно выбрать тип сервиса (протокола) (WMS, WFS, WCS, WPS, CSW, SOS) и его версию.
    -    *Удалённая аутентификация* - Учетные данные для базовой HTTP-аутентификации на сервере CSW (Логин и Пароль).
-   **Параметры создания записей** - Сборщик создаёт запись метаданных на основе ответа GetCapabilities-запроса. Регулировать создание можно следующими полями.
    -    *Создать по шаблону метаданные сервиса* - Это позволяет при первом запуске использовать шаблон и вводить в него информацию GetCapabilities.
    -    *Категория для метаданных сервиса*
    -    *Создать запись для каждого слоя, используя только информацию GetCapabilities* 
    -    *Категория ISO* - Рекомендуется выбрать одну, поскольку категория тем является обязательной для стандарта ISO19115/19139, если иерархическим уровнем является «наборы данных».
    -    *Язык метаданных* - Обязательное поле, определяющее язык метаданных.
    -    *Выходная схема* - Схема метаданных записей метаданных набора данных, которые будут созданы этим сборщиком..

-   **Правила слияния UUID** - Действие при дублировании UUID.
-   **Фильтрация и обработка ответа**
    -    *Проверка записей перед импортом* - Проверка записей перед импортом.
    -    *Поиск дубликатов ресурсов по идентификатору ресурса* - Сравнение выполнено по элементу 'gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:identifier/*/gmd:code/gco:CharacterString'. Оно применимо только к записям по ISO19139 или профилям ISO.
    -    *XPath фильтр* - Когда запись получена с удаленного сервера, проверьте выражение XPath, чтобы принять или отклонить запись. 
    -    *XSL-преобразование* - XSL-преобразование, которое будет применено к каждой записи перед добавлением в GeoNetwork.
    -    *Пакетное редактирование* - Пакетное обновление собираемых метаданных. Используется для добавления, замены или удаления элементов записей.
    -    *Категория для собранных записей* - Задать категорию собранным записям.
-   **Доступность для собранных записей** - Назначение привилегий определённым группам по собранным метаданным.
    -    *Если запись существует* - Применяется только при обновлении, и если при конфликте UUID предписано задано перезаписывать записи. Если включено, привилегии не удаляются при обновлении.

!!! Примечание

    -   При каждом запуске сборщик будет удалять ранее собранные записи и создавать новые. 
        GeoNetwork будет генерировать uuid для всех метаданных (как служебных, так и наборов данных). 
        Исключением из этого правила являются метаданные наборов данных, созданные с помощью тега MetadataUrl в документе GetCapabilities. 
        В этом случае вместо uuid используется uuid удаленного XML-документа.
    -   Логотипы (миниатюры) для метаданных могут быть сгенерированы только при сборе из WMS-сервера. WMS должна поддерживать проекцию WGS84
    -   Выбранная *Целевая схема* должна иметь поддержку XSLT, которые используются сборщиком для преобразования запроса GetCapabilities в записи метаданных из этой схемы. Обычно используется iso19139.
