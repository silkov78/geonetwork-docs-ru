# Управление тезаурусом

## Введение

Тезаурус - это список понятий из специализированной области знаний. 
В каталоге метаданных понятиям из тезауруса может быть присвоена запись метаданных (в виде ключевых слов), 
чтобы связать их с одним или несколькими понятиями из области знаний. 
Например, записи может быть присвоено ключевое слово "СЕЛЬСКОЕ ХОЗЯЙСТВО - сельскохозяйственные культуры", 
что означает, что запись описывает ресурс или деятельность, связанные с сельскохозяйственными культурами. 
Рекомендуется ознакомиться с существующими тезаурусами, прежде чем создавать свой собственный тезаурус.

В GeoNetwork процесс присвоения ключевых слов записи метаданных выполняется в редакторе метаданных. 
Пользователь может выбрать понятия из одного или нескольких тезаурусов, чтобы связать запись с понятиями, описываемыми этими понятиями. 
Этот процесс поддерживается как для записей метаданных ISO19115/19139, 
так и для записей метаданных dublin core с использованием средства выбора тезауруса.

Понятия в рамках одной области знаний или в разных областях знаний могут быть связаны или даже эквивалентны. 
Например, в тезаурусе, описывающем географические регионы, австралийский штат "Тасмания" является специализацией страны Австралия. 
В качестве примера совпадающих концепций в разных областях, тезаурус, описывающий научную деятельность в области глобальных изменений, 
может содержать концепции, относящиеся к сельскохозяйственной деятельности, которые будут эквивалентны терминам из тезауруса, 
описывающего темы, используемые в серии карт.

В GeoNetwork тезаурусы представлены в виде SKOS (<http://www.w3.org/TR/skos-reference>) 
и хранятся в кодировке application/xml+rdf. SKOS отображает понятия и взаимосвязи между понятиями. 
Тезаурусы SKOS могут быть импортированы из отдельных файлов или сгенерированы из записей реестра ISO19135 в каталоге GeoNetwork. 
Стандарт ISO19135 (подробнее об этом ниже) описывает не только концепции и взаимосвязи между концепциями, 
но и (среди прочего) то, как развивались концепции и, что наиболее важно, кто вносил свой вклад в эволюцию концепций и самого тезауруса и руководил ею.

## Внешние, локальные и регистровые тезаурусы

В GeoNetwork существует три типа тезаурусов. Различные типы зависят от источника тезауруса:

- *Внешний*: тезаурус, управляемый внешней организацией и импортированный в виде файла SKOS. 
  Он помечен как "внешний", что означает, что пользователям запрещено редактировать тезаурус.

- *Локальный*: Тезаурус, созданный в редакторе тезаурусов GeoNetwork и сохраненный в виде файла SKOS. 
  Он помечен как "локальный", что означает, что пользователям разрешено редактировать тезаурус.

- *Регистрация*: Тезаурус SKOS, созданный на основе записи реестра ISO19135. 
  Пользователи могут редактировать тезаурус, изменив содержимое записи реестра ISO19135 в редакторе метаданных GeoNetwork, 
  а затем повторно создав тезаурус. Пользователи не могут редактировать тезаурус в диспетчере тезаурусов.

## ISO19115/19139 Категории тезауруса

Все тезаурусы в GeoNetwork классифицируются с использованием значений списка кодов для элемента gmd:MD_KeywordTypeCode из ISO19115/19139. Категории и их значения приведены ниже, но также могут быть найдены в <http://www.isotc211.org/2005/resources/gmxCodelist.xml>:

| Категория тезауруса ISO | Описание                                                                      |
|-------------------------|-------------------------------------------------------------------------------|
| место                   | В тезаурусе есть понятия, идентифицирующие местоположение                     |
| слой                    | в тезаурусе есть понятия, идентифицирующие слои любого отложившегося вещества |
| временной               | В тезаурусе есть понятия, идентифицирующие период времени                     |
| предмет                 | Тезаурус содержит понятия, определяющие конкретный предмет или тему           |
| область знаний          | Тезаурус содержит понятия, определяющие раздел обучения или специализацию     |


## Формат SKOS

Простые системы организации знаний (SKOS) <http://www.w3.org/2004/02/skos/> - это область работы, 
разрабатывающая спецификации и стандарты для поддержки использования систем организации знаний (KOS), 
таких как тезаурусы, схемы классификации. Этот формат используется в GeoNetwork для хранения тезаурусной информации.

Концепция определяется идентификатором, предпочтительной меткой, определением и связями с другими концепциями. 
Метки и определения могут храниться на нескольких языках (с помощью атрибутов xml:lang). В формате SKOS определены три типа связей между понятиями:

- связанные термины
- более широкие термины
- более узкие термины

Например, понятие `ABLETTE` может быть определено как follow с меткой на французском и английском языках, связанной с более широким понятием:

    <skos:Concept rdf:about="http://www.oieau.org/concept#c4fc54576dc00227b82a709287ac3681">
        <skos:prefLabel xml:lang="fr">ABLETTE</skos:prefLabel>
        <skos:prefLabel xml:lang="en">BLEAK</skos:prefLabel>
        <skos:broader rdf:resource="http://www.oieau.org/concept#9f25ece36d04776e09492c66627cccb9"/>
    </skos:Concept>

GeoNetwork поддерживает многоязычные тезаурусы (например, Agrovoc). 
Поиск и редактирование происходит на текущем языке пользовательского интерфейса 
(т.е. если интерфейс на английском, то при редактировании метаданных GeoNetwork будет искать понятия только на английском).

Мы используем SKOS для представления тезаурусов в GeoNetwork, потому что:

- он обеспечивает простой и компактный метод описания концепций и отношений между концепциями из какой-либо области знаний
- Концепции SKOS можно запрашивать и управлять ими с помощью программного обеспечения sesame/openRDF, используемого в GeoNetwork

## Формат регистра ISO19135

ISO19135 - это стандарт ISO, который описывает процедуры регистрации элементов и схему описания списка 
(или реестра) элементов и процессов, с помощью которых эти элементы могут создаваться и изменяться. 
Эта схема доступна в виде плагина для использования в GeoNetwork. Чтобы использовать ее, 
нужно загрузить и загрузить схему плагина iso19135 в GeoNetwork. 
FIXME: Нам нужен стандартный способ ссылки на подключаемые схемы и стандартное место, откуда их можно загрузить.

Типичная запись регистра ISO19135 описывает:

- название и описание регистра
- информация о версии и языке
- контактную информацию тех, кто играет определенную роль в реестре (например, менеджер, вкладчик, хранитель, издатель и т.д.)
- элементы, используемые для описания элемента в регистре
- элементы

Стандартная информация, используемая для описания элемента регистра, включает:

- идентификатор
- название и описание элемента
- область применения
- происхождение и ссылки на связанные элементы регистра.

Ниже приведен пример элемента регистра из регистра научных ключевых слов NASA GCMD (Global Change Master Directory).

    <grg:RE_RegisterItem uuid="d1e7">
       <grg:itemIdentifier>
          <gco:Integer>7</gco:Integer>
       </grg:itemIdentifier>
       <grg:name>
          <gco:CharacterString>Aquaculture</gco:CharacterString>
       </grg:name>
       <grg:status>
          <grg:RE_ItemStatus>valid</grg:RE_ItemStatus>
       </grg:status>
       <grg:dateAccepted>
          <gco:Date>2006</gco:Date>
       </grg:dateAccepted>
       <grg:definition gco:nilReason="missing"/>
       <grg:itemClass xlink:href="#Item_Class"/>
       <grg:specificationLineage>
          <grg:RE_Reference>
             <grg:itemIdentifierAtSource>
                <gco:CharacterString>5</gco:CharacterString>
             </grg:itemIdentifierAtSource>
             <grg:similarity>
                <grg:RE_SimilarityToSource codeListValue="generalization"
                   codeList="http://ww.../lists.xml#RE_SimilarityToSource"/>
             </grg:similarity>
          </grg:RE_Reference>
       </grg:specificationLineage>
    </grg:RE_RegisterItem>


Как упоминалось ранее, чтобы использовать тезаурус, описанный записью регистра ISO19135, GeoNetwork использует XSLT под названием xml_iso19135ToSKOS.xsl 
(из субкаталога convert в схеме плагина iso19135), чтобы извлечь из записи регистра ISO19135 следующее:

- действительные понятия (grg:itemIdentifier, grg:name, grg:status)
- связи с другими концепциями (grg:specificationLineage)
- название, версия и другая управляющая информация.

Эта информация используется для создания файла SKOS. 
Файл SKOS затем доступен для запросов и управления с помощью программного обеспечения sesame/openRDF, используемого в GeoNetwork.

## Создание или импорт тезауруса

Внешние и локальные тезаурусы создаются или импортируются с помощью менеджера тезаурусов. Вы можете использовать менеджер тезаурусов, если:

- войти в систему как администратор
- перейдите на страницу «Администрирование» и нажмите на ссылку `Управление тезаурусами`.

На странице менеджера тезаурусов будет показан список тезаурусов, которые были созданы или импортированы. 
Верхняя часть страницы предоставляет пользователю функции для редактирования, добавления, изменения или поиска тезауруса. 
В нижней части находится функция загрузки внешнего тезауруса в формате SKOS.

### Создание локального тезауруса

Чтобы создать локальный тезаурус, нажмите знак `+` на категории, в которой планируется разместить свой тезаурус. 
После создания тезаурус можно обновлять через интерфейс редактирования. Значение каждого столбца следующее:

- **Тип** - это идентификатор, присвоенный тезаурусу в GeoNetwork. Он состоит из категории ISO, к которой был отнесен тезаурус 
 (см. список кодов для элемента gmd:MD_KeywordTypeCode в <http://www.isotc211.org/2005/resources/gmxCodelist.xml>), 
- является ли тезаурус локальным, внешним или регистровым, а также имени файла SKOS, в котором содержится тезаурус. 
- (Примечание: имя файла, используемого для хранения тезауруса регистра, является uuid записи регистра ISO19135, которая описывает тезаурус).

- **Имя** - это имя тезауруса, которое задается администратором при создании, или имя файла, 
  если тезаурус используется для создания тезауруса, то именем тезауруса будет имя файла, в котором хранится тезаурус.

Для каждого тезауруса доступны следующие кнопки:

- **Скачать** - ссылка на файл SKOS RDF.
- **Удалить** - Удалить тезаурус из текущего узла.
- **Просмотр** - Если тип внешний, кнопка просмотра позволяет искать и просматривать понятия.
- **Редактировать** - Если тип локальный, кнопка редактирования позволяет искать, добавлять, удалять и просматривать концепции.


### Импорт внешнего тезауруса

GeoNetwork позволяет импортировать тезаурус в формате SKOS. После загрузки внешний тезаурус не может быть обновлен. 
Выберите категорию, найдите файл тезауруса и нажмите кнопку загрузить. SKOS-файл будет находиться в папке 
`GEONETWORK_DATA_DIR/config/codelist/external/thesauri/<category>`.

В нижней части страницы находятся следующие кнопки:

1.  *Назад*: Возврат на главную страницу администрирования.
2.  *Загрузить*: Загрузите выбранный RDF-файл на узел. После этого появится список всех тезаурусов, доступных на узле.

### Создание тезауруса регистра

Запись ISO19135 в локальном каталоге GeoNetwork может быть преобразована в SKOS-файл и использована в качестве тезауруса в GeoNetwork. 
Записи ISO19135, отсутствующие в локальном каталоге, могут быть получены из других каталогов (например, из каталога организации, управляющей регистром).
Как только запись регистра ISO19135 попадает в локальный каталог, начинается процесс ее превращения в тезаурус для использования в селекторе ключевых слов. 
Найдя запись в результатах поиска, одним из действий над ней является «Создать/обновить тезаурус».

> *Результаты поиска показывают запись ISO19135 с действием по созданию тезауруса*.

Выбрав это действие, можно выбрать категорию тезауруса ISO, подходящую для этого тезауруса:

> *Выбор категории тезауруса ISO при создании тезауруса*

После выбора категории тезауруса ISO запись регистра ISO19135 преобразуется в файл SKOS и устанавливается как тезаурус, 
готовый к использованию в редакторе метаданных. Как описано выше в разделе об ISO19135, 
в тезаурус включаются только действительные элементы регистра. Это поведение и любые сопоставления между элементами регистра ISO19135 
и файлом тезауруса SKOS можно изменить или проверить, просмотрев XSLT xml_iso19135TOSKOS.xsl в подкаталоге convert плагина схемы iso19135.

## Редактирование/просмотр локального или внешнего тезауруса: добавление/удаление/просмотр ключевых слов

В интерфейсе администрирования тезауруса нажмите на кнопку редактирования для локального тезауруса или кнопку просмотра для внешнего тезауруса. 
Этот интерфейс позволяет:

- поиск ключевых слов
- добавлять/удалять ключевые слова для локального тезауруса.

Для поиска ключевых слов используйте текстовое поле и тип поиска.

## Редактирование тезауруса регистра

Тезаурус регистра создается на основе записи метаданных ISO19135, как описано выше, 
поэтому тезаурус регистра обновляется путем редактирования записи метаданных ISO19135 и последующей регенерации тезауруса регистра. 
Запись метаданных ISO19135 можно создать и отредактировать в редакторе GeoNetwork.

### Подготовка к редактированию записи по реестру ISO19135 {#xlinks_thesaurus}

Записи в реестре могут быть очень большими. Например, запись в реестре, описывающая реестр названий географических экстентов ANZLIC, 
содержит около 1800 элементов реестра. Каждый элемент реестра содержит не только название географического экстента, 
но также его географический экстент и сведения о происхождении, взаимосвязи с другими терминами и, возможно, 
эволюцию экстента (изменения названия, географического экстента), включая подробную информацию об изменениях и причинах их возникновения. 
Редактирование такой большой записи в редакторе GeoNetwork может вызвать проблемы с производительностью как для браузера, так и для сервера, 
поскольку редактор создает HTML-форму, описывающую всю запись целиком. К счастью, существует гораздо более масштабируемый подход, 
основанный на извлечении элементов регистра из записи регистра ISO19135 и сохранении их в виде подтемплат 
(по сути, небольших записей метаданных, содержащих только содержимое элемента регистра). 
Процесс извлечения элементов реестра из записи реестра ISO19135 выглядит следующим образом:

- найдите и выберите запись реестра
- выберите "Извлечь элементы реестра" в меню "Действия с выбранным набором"
- После извлечения элементов реестра вы должны увидеть сводку результатов, подобную приведенной ниже.
- Цифра "Извлеченные подшаблоны" - это количество элементов регистра, извлеченных из записи регистра ISO19135.

### Редактирование элемента регистра

Чтобы отредактировать/изменить любой из элементов регистра, которые были извлечены в качестве подшаблонов, 
можно использовать интерфейс управления каталогами. Доступ к этому интерфейсу осуществляется из меню "Администрирование" 
в разделе "Управление каталогами". В этом интерфейсе:

- выберите "Зарегистрированный элемент (Геосеть)" в качестве типа подшаблона для редактирования следующим образом.
- введите поисковый запрос или просто выберите опцию поиска, чтобы получить первые 50 зарегистрированных элементов.
- элементы регистрации появятся на панели слева, при выборе одного из них откроется интерфейс редактирования на панели справа.

### Редактирование информации глобального реестра

Чтобы отредактировать/изменить любую информацию глобального реестра (например, владельца реестра, менеджера, версию, языки),
отредактируйте запись реестра в обычном интерфейсе редактирования метаданных GeoNetwork.

## Редактирование метаданных: добавление ключевых слов

При редактировании записи метаданных ISO можно использовать средство выбора ключевых слов (или концепций), которое позволяет редактору:

- выполнять поиск ключевых слов в одном или нескольких тезаурусах каталога (результаты поиска отображаются слева).
- выберите одно или несколько ключевых слов и добавьте их в список выбранных элементов (с помощью стрелок или перетаскивания) справа.
- добавьте выбранные ключевые слова непосредственно в метаданные, сгруппировав ключевые слова по тезаурусу.

Редактор также может управлять количеством ключевых слов из поисковых запросов, отображаемых в окне выбора ключевых слов (по умолчанию - 50).

Обратите внимание, что URL-адрес, указывающий на исходный тезаурус, включен в название тезауруса citation 
(фактический элемент, используемый для этого, - gmd:otherCitationDetails/gmx:FileName). 
Тезаурус можно загрузить в виде файла SKOS, если это локальный или внешний тезаурус. 
Для тезауруса register URL ссылается на запись реестра ISO19135, на основе которой был создан тезаурус.

## Критерии поиска: ключевые слова

Можно выполнять поиск по ключевым словам с помощью панели facet. 
Все ключевые слова хранятся в индексном поле "tag" и также доступны в поле, зависящем от названия тезауруса, 
например. `th_theme` для тем INSPIRE. Название поля зависит от типа тезауруса и имени файла.
