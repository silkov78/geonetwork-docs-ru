# Анализ и визуализация данных {#analyzing_data}

## Данные из WFS 

Все данные, описанные в записях метаданных и доступные через [WFS](https://live.osgeo.org/archive/8.0/ru/standards/wfs_overview.html), могут быть проанализированы, чтобы:
- Улучшить поиска метаданных
- Улучшить визуализациюи данных на карте
Каталог анализирует WFS-объекты и **индексирует** их.

![](img/mechanism.png)

Elasticsearch должен быть установлен и настроен (см. [Установка поисковой платформы](../../install-guide/installing-index.md)).

Когда информация о набора данных с WFS-сервера получена, становится доступна фильтрация в средстве просмотра карты для рассматриваемого набора данных. Интерфейс фильтрации предоставляет возможность разбиения набора данных на поднабора, а также возможность экспорта. Средство просмотра карт пытается подключиться к службе WFS, заменяя в URL службы WMS на WFS. Если такой запрос на WFS-сервис успешный, панель фильтрации предоставляет возможность индексировать объекты у рассматриваемого набора данных. Пользователь должен быть авторизован, чтобы запустить процесс индексирования.

![](img/layernotindexed.png)

После индексации все пользователи могут получить доступ к меню фильтрации, обеспечивающему:

- текстовый поиск по всем полям набора данных
- контроль отображения тепловой карты (heatmap)
- разбиения набора данных по всем полям (автоматическое вычисление диапазона для чисел)
- отображения всех значений в таблице
- применять фильтры к слоям WMS, используя SLD

![](img/filtering.png)

Нажмите на меню таблицы, чтобы отобразить атрибуты. Дважды щелкните строку в таблице, чтобы изменить масштаб атрибута.

![](img/tableview.png)

Также можно применять пространственные фильтры.

![](img/filteringlayer.png)

## Настройка типа объекта

По умолчанию панель фильтров формируется на основе индекса Elasticsearch. Но вы можете настроить ее для определенного WFS-объекта из набора данных.

Настройка осуществляется с помощью конфигурационного JSON-файла, вставленного в раздел gmd:applicationProfile онлайн-ресурса в метаданных.

Вот параметры:

```json
{
  «fields": [{
    «name": «PNT_PROF»,
    // non disponible actuellement
    «type": «double»,
    «fq» : {
      «facet.interval": «PNT_PROF_d»,
      «facet.interval.set": [«[0,10]», «(10,10000]»],
     или
      «facet.range": «PNT_PROF_d»,
      «facet.range.start": «0»,
      «facet.range.end": «10000»,
      «facet.range.gap": «300»
     или
      «facet.range": «PNT_PROF_d»,
      «facet.range.classes": «5» // Получаем min, max и вычисляем разрыв по 5 классам
    }
  }, {
    «name": «GRIDCODE»
  }, {
    «name": «LABEL»,
    «label» : { „fr“: «monLabel», „en“: «myLabel"}
  }],
  «tokenize": { «GRIDCODE»: »,», „PARCELLE“: «/"},
  «heatmap": true
}
```

Пользователь может:
- ограничить поля, используемые для фильтра
- указывать собственные диапазоны для числовых значений
- задать свою метку
- управлять токенизированными полями
- включить тепловую карту