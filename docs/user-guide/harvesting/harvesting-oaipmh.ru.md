# Сбор по протоколу OAI-PMH {#oaipmh_harvester}

Протокол [OAI-PMH](https://www.openarchives.org/pmh/) - это протокол сбора, который широко используется библиотеками. GeoNetwork использует версию 2.0 протокола.

## Добавление сборщика OAI-PMH

Сервер OAI-PMH реализует протокол сбора, который GeoNetwork, выступая в качестве клиента, может использовать для сбора метаданных.
Нажмите `Собрать из` - `OAI-PMH`, чтобы создать сборщика, собирающего данные по протоколу OAI-PMH. Доступные параметры следующие:

-   **Идентификация** - параметры собранных данных в каталоге GeoNetwork.
    -    *Имя* - Это краткое описание удаленного сайта. Оно будет показано на главной странице сбора в качестве имени для этого экземпляра CSW-харвестера.
    -    *Выбор логотипа* - Логотип будет использоваться при отображении собранных записей метаданных в результатах поиска.
    -    *Группа* - Группа, в которой разместятся собираемые метаданные.
    -    *Пользователь* - Пользователь, который будет владельцем собранных метаданных.
-   **Расписание** - Параметры расписания, согласно которым сборщик будет собирать метаданные.
    -    *Частота* - Частота (периодичность) запуска сбора метаданных харвестером.
    -    *Только один запуск* - Сборщик будет запущен только один раз, если выбран пункт.
-   **Настроить подключение** - параметры подключения к CSW-серверу.
    -    *URL сервиса* - URL CSW с параметрами GetCapabilities или без них. Например, <http://geonetwork-site.com/srv/eng/csw?service=CSW&request=GetCabilities&version=2.0.2>.
    -    *Удалённая аутентификация* - Учетные данные для базовой HTTP-аутентификации на сервере CSW (Логин и Пароль).
-   **Фильтр поиска**
    -   *От (From)* - Здесь можно указать начальную дату. Будут собраны любые метаданные, дата последнего изменения которых равна или больше этой даты. Чтобы добавить или изменить значение для этого поля, необходимо нажать на значок рядом с текстовым полем. Это поле необязательно, поэтому, если вы не укажете начальную дату, ограничение будет удалено. Используйте значок, чтобы очистить поле.
    -   *До (Until)* - Работает так же, как параметр *From*, но добавляет конечное ограничение к поиску даты последнего изменения. Будут собраны любые метаданные, дата последнего изменения которых меньше или равна этим данным.
    -   *Набор (Set)* - Сервер OAI-PMH классифицирует метаданные в наборы (подобно категориям в GeoNetwork). Вы можете запросить все записи метаданных, которые принадлежат набору (и любому из его подмножеств), указав здесь имя этого набора.
    -   *Префикс* - «Prefix» означает формат метаданных. Префикс oai_dc должен поддерживаться всеми серверами, совместимыми с OAI-PMH.
    -   Пользователь может использовать кнопку «Добавить», чтобы добавить более одного набора критериев поиска. Наборы критериев поиска можно удалить, нажав на маленький крестик в левом верхнем углу набора.

-   **Параметры поиска** - специфические параметры сбора для этого харвестера.
    -    *Сортировка по* - Определение порядка сортировки для запроса GetRecords. Это может решить проблему для больших наборов, когда некоторые записи могут измениться на удаленном узле во время сбора данных и вернуться на разных страницах. Сортировка A - это UUID в алфавитном порядке.
    -    *Выходная схема* - Идентификатор URI запрошенного с CSW сервера стандарта метаданных. Сервер должен поддерживать этот стандарт. Поддерживаемые стандарты перечислены в документе CSW Capabilities в операции GetRecordById.
    -    *Распределенный поиск* - Распределенный поиск на удаленном сервере (если он это обеспечивает). Когда эта опция включена, удаленный каталог направляет поиск на настроенные удалённые CSW-серверы
-   **Правила слияния UUID** - Действие при дублировании UUID.
-   **Фильтрация и обработка ответа**
    -    *Проверка записей перед импортом* - Проверка записей перед импортом.
    -    *Поиск дубликатов ресурсов по идентификатору ресурса* - Сравнение выполнено по элементу 'gmd:identificationInfo/*/gmd:citation/gmd:CI_Citation/gmd:identifier/*/gmd:code/gco:CharacterString'. Оно применимо только к записям по ISO19139 или профилям ISO.
    -    *XPath фильтр* - Когда запись получена с удаленного сервера, проверьте выражение XPath, чтобы принять или отклонить запись. 
    -    *XSL-преобразование* - XSL-преобразование, которое будет применено к каждой записи перед добавлением в GeoNetwork.
    -    *Пакетное редактирование* - Пакетное обновление собираемых метаданных. Используется для добавления, замены или удаления элементов записей.
    -    *Категория для собранных записей* - Задать категорию собранным записям.

!!! Примечание

    Раскрывающийся список текстовым полем *Набор (Set)* и раскрывающийся список с текстовым полем *Префикс* изначально пусты. После указания URL-адреса подключения вы можете нажать кнопку **Получить информацию**, которая подключится к удаленному серверу OAI-PMH, получит все поддерживаемые наборы и префиксы и заполнит раскрывающиеся списки этими значениями. Выбор значения из любого из этих раскрывающихся списков заполнит соответствующее текстовое поле выбранным значением.

-   **Доступность для собранных записей** - Назначение привилегий определённым группам по собранным метаданным.
    -    *Если запись существует* - Применяется только при обновлении, и если при конфликте UUID предписано задано перезаписывать записи. Если включено, привилегии не удаляются при обновлении.


!!! Примечания

- если пользователь запросит выходной формат oai_dc, GeoNetwork преобразует его в формат Dublin Core.
- при редактировании ранее созданного экземпляра харвестера OAIPMH оба выпадающих списка `Набор` (set) и `Префикс` будут пустыми. Вам нужно снова нажать кнопку получения информации, чтобы подключиться к удаленному серверу и получить информацию о наборе и префиксе.
- идентификатор удаленного сервера должен быть UUID. В противном случае метаданные могут быть собраны, но во время иерархического распространения конфликты идентификаторов могут повредить собранные метаданные.